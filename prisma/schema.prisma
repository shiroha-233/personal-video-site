// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Video {
  id          String     @id @default(cuid())
  title       String
  description String
  coverImage  String
  videoUrl    String?
  duration    String?
  publishDate DateTime   @default(now())
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  
  // Relations
  resources   Resource[]
  tags        VideoTag[]
  
  @@map("videos")
}

model Resource {
  id          String  @id @default(cuid())
  name        String
  type        String  // github, baidu, aliyun, onedrive, other
  url         String
  password    String?
  description String?
  
  // Relations
  video       Video   @relation(fields: [videoId], references: [id], onDelete: Cascade)
  videoId     String
  
  @@map("resources")
}

model Tag {
  id       String     @id @default(cuid())
  name     String     @unique
  createdAt DateTime  @default(now())
  
  // Relations
  videos   VideoTag[]
  
  @@map("tags")
}

model VideoTag {
  id      String @id @default(cuid())
  
  // Relations
  video   Video  @relation(fields: [videoId], references: [id], onDelete: Cascade)
  videoId String
  tag     Tag    @relation(fields: [tagId], references: [id], onDelete: Cascade)
  tagId   String
  
  @@unique([videoId, tagId])
  @@map("video_tags")
}